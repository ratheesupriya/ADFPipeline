{
	"name": "dataflow1",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "Stage1_Sales_SAL_SWINVC_TB",
						"type": "DatasetReference"
					},
					"name": "Stage1SalesSALSWINVCTB"
				},
				{
					"dataset": {
						"referenceName": "Stage1_Sales_AfterSales_CMM_CMCD_TB",
						"type": "DatasetReference"
					},
					"name": "Stage1SalesAfterSalesCMMCMCDTB"
				}
			],
			"sinks": [],
			"transformations": [
				{
					"name": "Transformation1"
				},
				{
					"name": "select1"
				}
			],
			"scriptLines": [
				"source(output(",
				"          INVC_DLR_NO as string,",
				"          INVC_NO as string,",
				"          INVC_CORP_NO as string,",
				"          INVC_CMPN_NO as string,",
				"          INVC_TYPE as string,",
				"          INVC_CNFM_YN as string,",
				"          INVC_CNFM_DATE as string,",
				"          INVC_DATE as string,",
				"          INVC_INSR_YN as string,",
				"          INVC_INSR_AMT as string,",
				"          INVC_INSR_DATE as string,",
				"          INVC_INSR_TYPE as string,",
				"          INVC_INSR_NO as string,",
				"          INVC_RGSTN_NO as string,",
				"          INVC_RGSTN_DATE as string,",
				"          INVC_DLVRY_DATE as string,",
				"          INVC_ADDR1 as string,",
				"          INVC_ADDR2 as string,",
				"          INVC_ADDR3 as string,",
				"          INVC_RGN_CODE as string,",
				"          INVC_STCD_CODE as string,",
				"          INVC_CITY_CODE as string,",
				"          INVC_LCTN_CODE as string,",
				"          INVC_PIN_CODE as string,",
				"          INVC_CNCL_YN as string,",
				"          INVC_CNCL_DATE as string,",
				"          INVC_CNCL_RMRKS as string,",
				"          INVC_BKNG_NO as string,",
				"          INVC_CRTE_DTIME as string,",
				"          INVC_CRTE_EMP_NO as string,",
				"          INVC_UPDT_DTIME as string,",
				"          INVC_UPDT_EMP_NO as string,",
				"          INVC_ACTRL_USR_YN as string,",
				"          INVC_DN_DATE as string,",
				"          INVC_DLVRY_CNFM_YN as string,",
				"          INVC_CC_REQ as string,",
				"          INVC_CC_REASON as string,",
				"          INVC_CC_RDATE as string,",
				"          INVC_CC_RMRKS as string,",
				"          INVC_CC_RA_YN as string,",
				"          INVC_CC_STATUS as string,",
				"          INVC_CC_REQ_VERSION as string,",
				"          INVC_HMIL_EMP_CODE as string,",
				"          INVC_ENQRY_NO as string,",
				"          INVC_REGI_FILE_DOC_NO as string,",
				"          INVC_DLVRY_FILE_DOC_NO as string,",
				"          INVC_REGI_CUST_NO as string,",
				"          INVC_REGI_RELAT_SHIP as string,",
				"          INVC_VIN_NO as string,",
				"          INVC_BASIC_PRCE as string,",
				"          INVC_VRNT_PRCE as string,",
				"          INVC_ADVNC_EMI as string,",
				"          INVC_LOAN_AMT as string,",
				"          INVC_WTYNLTY_CFC_YN as string,",
				"          INVC_EQCR_SEQ as string,",
				"          INVC_ALCN_DATE as string,",
				"          INVC_SCHEME_YN as string,",
				"          INVC_MYKIA as string,",
				"          INVC_MYKIA_REG_DATE as string,",
				"          INVC_MK_VINLINK_DT as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false) ~> Stage1SalesSALSWINVCTB",
				"source(output(",
				"          CMPN_NO as string,",
				"          CORP_NO as string,",
				"          CMM_GRP_CODE as string,",
				"          CMM_CODE as string,",
				"          CMM_CODE_NAME as string,",
				"          REMARK_1 as string,",
				"          REMARK_2 as string,",
				"          REMARK_3 as string,",
				"          REMARK_4 as string,",
				"          REMARK_5 as string,",
				"          USED_YN as string,",
				"          PRIORITY as string,",
				"          CRTE_EMP_NO as string,",
				"          CRTE_DTIME as string,",
				"          UPDT_EMP_NO as string,",
				"          UPDT_DTIME as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false) ~> Stage1SalesAfterSalesCMMCMCDTB",
				"Stage1SalesSALSWINVCTB derive(IY = left(INVC_CNFM_DATE,4),",
				"          ID = right(INVC_CNFM_DATE,2),",
				"          IM = substring(INVC_CNFM_DATE,6,2)) ~> Transformation1",
				"Stage1SalesAfterSalesCMMCMCDTB select(mapColumn(",
				"          CMPN_NO,",
				"          CORP_NO,",
				"          CMM_GRP_CODE,",
				"          CMM_CODE,",
				"          CMM_CODE_NAME,",
				"          REMARK_1,",
				"          REMARK_2,",
				"          REMARK_3,",
				"          REMARK_4,",
				"          REMARK_5,",
				"          USED_YN,",
				"          PRIORITY,",
				"          CRTE_EMP_NO,",
				"          CRTE_DTIME,",
				"          UPDT_EMP_NO,",
				"          UPDT_DTIME",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select1"
			]
		}
	}
}